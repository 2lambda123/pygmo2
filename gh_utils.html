

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Gradient and Hessians utilities &mdash; pygmo 2.16.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/logo_favico.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hypervolume utilities" href="hv_utils.html" />
    <link rel="prev" title="Constrained optimization utilities" href="con_utils.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> pygmo
          

          
          </a>

          
            
            
              <div class="version">
                2.16.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api_reference.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#core-classes">Core classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#implemented-user-defined-classes">Implemented user-defined classes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="api_reference.html#utilities">Utilities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="generic_utils.html">Generic optimization utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="mo_utils.html">Multi-objective optimization utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="con_utils.html">Constrained optimization utilities</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Gradient and Hessians utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="hv_utils.html">Hypervolume utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="genetic_op_utils.html">Generic optimization utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html">Plotting utilities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="known_issues.html">Known issues</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pygmo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="api_reference.html">API reference</a> &raquo;</li>
        
      <li>Gradient and Hessians utilities</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/gh_utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="gradient-and-hessians-utilities">
<h1>Gradient and Hessians utilities<a class="headerlink" href="#gradient-and-hessians-utilities" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="pygmo.estimate_sparsity">
<code class="sig-prename descclassname">pygmo.</code><code class="sig-name descname">estimate_sparsity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">callable</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">dx</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygmo.estimate_sparsity" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a numerical estimation of the sparsity pattern of same callable object by numerically
computing it around the input point <em>x</em> and detecting the components that are changed.</p>
<p>The <em>callable</em> must accept an iterable as input and return an array-like object</p>
<p>Note that estimate_sparsity may fail to detect the real sparsity as it only considers one variation around the input
point. It is of use, though, in tests or cases where its not possible to write the sparsity or where the user is
confident the estimate will be correct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callable</strong> (<em>a callable object</em>) – The function we want to estimate sparsity (typically a fitness).</p></li>
<li><p><strong>x</strong> (<em>array-like object</em>) – decision vector to use when testing for sparisty.</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – To detect the sparsity each component of <em>x</em> will be changed by <span class="math notranslate nohighlight">\(\max(|x_i|,1) dx\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>unspecified</strong> – any exception thrown by the <em>callable</em> object when called on <em>x</em>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.9)"><strong>TypeError</strong></a> – if <em>x</em> cannot be converted to a vector of floats or <em>callable</em> is not callable.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the sparsity_pattern of <em>callable</em> detected around <em>x</em></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>2D NumPy float array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygmo</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pg</span><span class="o">.</span><span class="n">estimate_sparsity</span><span class="p">(</span><span class="n">callable</span> <span class="o">=</span> <span class="n">my_fun</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">)</span>
<span class="go">array([[0, 0],</span>
<span class="go">       [0, 3],</span>
<span class="go">       [1, 2],</span>
<span class="go">       [2, 1]], dtype=uint64)</span>
</pre></div>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="pygmo.estimate_gradient">
<code class="sig-prename descclassname">pygmo.</code><code class="sig-name descname">estimate_gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">callable</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">dx</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygmo.estimate_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a numerical estimation of the sparsity pattern of same callable object by numerically
computing it around the input point <em>x</em> and detecting the components that are changed.</p>
<p>The <em>callable</em> must accept an iterable as input and return an array-like object. The gradient returned will be dense
and contain, in the lexicographic order requested by <a class="reference internal" href="problem.html#pygmo.problem.gradient" title="pygmo.problem.gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">gradient()</span></code></a>, <span class="math notranslate nohighlight">\(\frac{df_i}{dx_j}\)</span>.</p>
<p>The numerical approximation of each derivative is made by central difference, according to the formula:</p>
<div class="math notranslate nohighlight">
\[\frac{df}{dx} \approx \frac{f(x+dx) - f(x-dx)}{2dx} + O(dx^2)\]</div>
<p>The overall cost, in terms of calls to <em>callable</em> will thus be <span class="math notranslate nohighlight">\(n\)</span> where <span class="math notranslate nohighlight">\(n\)</span> is the size of <em>x</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callable</strong> (<em>a callable object</em>) – The function we want to estimate sparsity (typically a fitness).</p></li>
<li><p><strong>x</strong> (<em>array-like object</em>) – decision vector to use when testing for sparisty.</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – To detect the sparsity each component of <em>x</em> will be changed by <span class="math notranslate nohighlight">\(\max(|x_i|,1) dx\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>unspecified</strong> – any exception thrown by the <em>callable</em> object when called on <em>x</em>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.9)"><strong>TypeError</strong></a> – if <em>x</em> cannot be converted to a vector of floats or <em>callable</em> is not callable.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dense gradient of <em>callable</em> detected around <em>x</em></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>2D NumPy float array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygmo</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pg</span><span class="o">.</span><span class="n">estimate_gradient</span><span class="p">(</span><span class="n">callable</span> <span class="o">=</span> <span class="n">my_fun</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">)</span> 
<span class="go">array([1., 0., 0., 1., 0., 0., 1., 0., 0., 1., 0., 0.])</span>
</pre></div>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="pygmo.estimate_gradient_h">
<code class="sig-prename descclassname">pygmo.</code><code class="sig-name descname">estimate_gradient_h</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">callable</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">dx</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygmo.estimate_gradient_h" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a numerical estimation of the sparsity pattern of same callable object by numerically
computing it around the input point <em>x</em> and detecting the components that are changed.</p>
<p>The <em>callable</em> must accept an iterable as input and return an array-like object. The gradient returned will be dense
and contain, in the lexicographic order requested by <a class="reference internal" href="problem.html#pygmo.problem.gradient" title="pygmo.problem.gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">gradient()</span></code></a>, <span class="math notranslate nohighlight">\(\frac{df_i}{dx_j}\)</span>.</p>
<p>The numerical approximation of each derivative is made by central difference, according to the formula:</p>
<div class="math notranslate nohighlight">
\[\frac{df}{dx} \approx \frac 32 m_1 - \frac 35 m_2 +\frac 1{10} m_3 + O(dx^6)\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[m_i = \frac{f(x + i dx) - f(x-i dx)}{2i dx}\]</div>
<p>The overall cost, in terms of calls to <em>callable</em> will thus be 6:math:<cite>n</cite> where <span class="math notranslate nohighlight">\(n\)</span> is the size of <em>x</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callable</strong> (<em>a callable object</em>) – The function we want to estimate sparsity (typically a fitness).</p></li>
<li><p><strong>x</strong> (<em>array-like object</em>) – decision vector to use when testing for sparisty.</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – To detect the sparsity each component of <em>x</em> will be changed by <span class="math notranslate nohighlight">\(\max(|x_i|,1) dx\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>unspecified</strong> – any exception thrown by the <em>callable</em> object when called on <em>x</em>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.9)"><strong>TypeError</strong></a> – if <em>x</em> cannot be converted to a vector of floats or <em>callable</em> is not callable.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dense gradient of <em>callable</em> detected around <em>x</em></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>2D NumPy float array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygmo</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pg</span><span class="o">.</span><span class="n">estimate_gradient_h</span><span class="p">(</span><span class="n">callable</span> <span class="o">=</span> <span class="n">my_fun</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">)</span> 
<span class="go">array([1., 0., 0., 1., 0., 0., 1., 0., 0., 1., 0., 0.])</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hv_utils.html" class="btn btn-neutral float-right" title="Hypervolume utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="con_utils.html" class="btn btn-neutral float-left" title="Constrained optimization utilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, pagmo development team

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>